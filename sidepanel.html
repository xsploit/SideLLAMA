<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SideLlama</title>
    <script src="tailwind.js"></script>
    <style>
        :root {
            --background: #fff;
            --foreground: #09090b;
            --card: #fff;
            --card-foreground: #09090b;
            --popover: #fff;
            --popover-foreground: #09090b;
            --primary: #18181b;
            --primary-foreground: #fafafa;
            --secondary: #f4f4f5;
            --secondary-foreground: #18181b;
            --muted: #f4f4f5;
            --muted-foreground: #71717a;
            --accent: #f4f4f5;
            --accent-foreground: #18181b;
            --destructive: #ef4444;
            --destructive-foreground: #fafafa;
            --border: #232425;
            --input: #e4e4e7;
            --ring: #09090b;
            --chart-1: #e76e50;
            --chart-2: #2a9d90;
            --chart-3: #274754;
            --chart-4: #e8c468;
            --chart-5: #f4a462;
            --radius: .5rem;
            --sidebar: #fafafa;
            --sidebar-foreground: #3f3f46;
            --sidebar-primary: #18181b;
            --sidebar-primary-foreground: #fafafa;
            --sidebar-accent: #f4f4f5;
            --sidebar-accent-foreground: #18181b;
            --sidebar-border: #e5e7eb;
            --sidebar-ring: #3b82f6;
            --font-sans: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            --color-green-500: oklch(.723 .219 149.579);
            --color-gray-200: oklch(.928 .006 264.531);
            --color-gray-300: oklch(.872 .01 258.338);
            --color-gray-400: oklch(.707 .022 261.325);
            --color-gray-500: oklch(.551 .027 264.364);
            --color-gray-700: oklch(.373 .034 259.733);
            --color-gray-900: oklch(.21 .034 264.665);
            --color-zinc-500: oklch(.552 .016 285.938);
            --color-zinc-600: oklch(.442 .017 285.786);
            --color-black: #000;
            --color-white: #fff;
            --spacing: .25rem;
            --container-sm: 24rem;
            --container-lg: 32rem;
            --container-3xl: 48rem;
            --text-xs: .75rem;
            --text-xs--line-height: calc(1 / .75);
            --text-sm: .875rem;
            --text-sm--line-height: calc(1.25 / .875);
            --text-base: 1rem;
            --text-base--line-height: 1.5;
            --text-lg: 1.125rem;
            --text-lg--line-height: calc(1.75 / 1.125);
            --text-xl: 1.25rem;
            --text-xl--line-height: calc(1.75 / 1.25);
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            --tracking-tight: -.025em;
            --tracking-widest: .1em;
            --radius-xs: .125rem;
            --radius-xl: .75rem;
            --radius-2xl: 1rem;
            --radius-4xl: 2rem;
            --ease-in-out: cubic-bezier(.4,0,.2,1);
            --animate-spin: spin 1s linear infinite;
            --animate-pulse: pulse 2s cubic-bezier(.4,0,.6,1) infinite;
            --default-transition-duration: .15s;
            --default-transition-timing-function: cubic-bezier(.4,0,.2,1);
            --default-font-family: var(--font-sans);
            --default-font-feature-settings: var(--font-sans--font-feature-settings);
            --default-font-variation-settings: var(--font-sans--font-variation-settings);
            --default-mono-font-family: var(--font-mono);
            --default-mono-font-feature-settings: var(--font-mono--font-feature-settings);
            --default-mono-font-variation-settings: var(--font-mono--font-variation-settings);
        }

        .dark {
            --background: #09090b;
            --foreground: #fafafa;
            --card: #09090b;
            --card-foreground: #fafafa;
            --popover: #09090b;
            --popover-foreground: #fafafa;
            --primary: #fafafa;
            --primary-foreground: #18181b;
            --secondary: #27272a;
            --secondary-foreground: #fafafa;
            --muted: #27272a;
            --muted-foreground: #a1a1aa;
            --accent: #27272a;
            --accent-foreground: #fafafa;
            --destructive: #7f1d1d;
            --destructive-foreground: #fafafa;
            --border: #27272a;
            --input: #27272a;
            --ring: #d4d4d8;
            --chart-1: #2662d9;
            --chart-2: #2eb88a;
            --chart-3: #e88c30;
            --chart-4: #af57db;
            --chart-5: #e23670;
            --sidebar: #18181b;
            --sidebar-foreground: #f4f4f5;
            --sidebar-primary: #1d4ed8;
            --sidebar-primary-foreground: #fff;
            --sidebar-accent: #27272a;
            --sidebar-accent-foreground: #f4f4f5;
            --sidebar-border: #27272a;
            --sidebar-ring: #3b82f6;
        }

        *, ::after, ::before {
            box-sizing: border-box;
            border-width: 0;
            border-style: solid;
            border-color: #232425;
        }

        /* Force all border classes to use dark grey */
        .border, .border-border, .border-b, .border-t, .border-l, .border-r {
            border-color: #232425 !important;
        }

        /* Override any default border colors */
        .ring, .ring-border {
            --tw-ring-color: #232425 !important;
            border-color: #232425 !important;
        }

        /* Comprehensive border color override */
        div, span, button, input, textarea, select, header, main, section, article, aside, nav, footer {
            border-color: #232425;
        }

        /* Override Tailwind CSS default border colors */
        [class*="border"] {
            border-color: #232425 !important;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--background);
            color: var(--foreground);
        }
        
        .scrollbar-none::-webkit-scrollbar {
            display: none;
        }
        
        .scrollbar-none {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--popover);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 4px;
            min-width: 180px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: none;
            z-index: 50;
        }

        .dropdown-menu.show {
            display: block;
        }

        .menu-item {
            padding: 8px 12px;
            color: var(--foreground);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            border-radius: 4px;
            transition: background-color 0.15s ease;
        }

        .menu-item:hover {
            background-color: var(--accent);
        }

        .menu-item.danger {
            color: var(--destructive);
        }

        .typing-indicator {
            display: none;
        }

        .typing-indicator.show {
            display: flex;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--muted-foreground);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { 
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% { 
                transform: scale(1);
                opacity: 1;
            }
        }

        .model-selector {
            display: none;
            background-color: var(--background);
            border-bottom: 1px solid var(--border);
            padding: 16px;
        }

        .model-selector.show {
            display: block;
        }

        .model-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 0;
            cursor: pointer;
        }

        .model-radio {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border);
            border-radius: 50%;
            position: relative;
        }

        .model-radio.selected {
            border-color: var(--primary);
        }

        .model-radio.selected::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 8px;
            height: 8px;
            background-color: var(--primary);
            border-radius: 50%;
        }

        .context-indicator {
            background-color: var(--muted);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 8px;
        }

        .context-indicator.active {
            background-color: rgba(34, 197, 94, 0.1);
            border-color: rgb(34, 197, 94);
            color: rgb(34, 197, 94);
        }

        .search-results {
            background-color: var(--muted);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .search-result {
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .search-result:last-child {
            border-bottom: none;
        }

        .search-result-title {
            font-weight: 600;
            color: var(--primary);
            text-decoration: none;
            font-size: 14px;
        }

        .search-result-title:hover {
            text-decoration: underline;
        }

        .search-result-snippet {
            color: var(--muted-foreground);
            font-size: 12px;
            margin-top: 4px;
            line-height: 1.4;
        }

        .screenshot-display img,
        .uploaded-image img {
            transition: transform 0.2s ease;
            cursor: pointer;
        }

        .screenshot-display img:hover,
        .uploaded-image img:hover {
            transform: scale(1.02);
        }

        .tool-call-indicator {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .quick-model-dropdown {
            background-color: var(--popover);
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: none;
        }

        .quick-model-dropdown.show {
            display: block;
        }

        .quick-model-item {
            padding: 8px 12px;
            cursor: pointer;
            transition: background-color 0.15s ease;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .quick-model-item:last-child {
            border-bottom: none;
        }

        .quick-model-item:hover {
            background-color: var(--accent);
        }

        .quick-model-item.selected {
            background-color: var(--accent);
            font-weight: 500;
        }

        .model-name {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
        }

        .model-size {
            font-size: 10px;
            color: var(--muted-foreground);
        }

        .model-badges {
            display: flex;
            gap: 4px;
        }

        .model-badge {
            font-size: 8px;
            padding: 1px 4px;
            border-radius: 4px;
            background-color: var(--muted);
            color: var(--muted-foreground);
        }

        .model-badge.tools {
            background-color: #3b82f6;
            color: white;
        }

        .model-badge.vision {
            background-color: #8b5cf6;
            color: white;
        }

        .model-badge.large {
            background-color: #f59e0b;
            color: white;
        }

        /* Ensure all input fields are visible */
        input, textarea, select {
            background-color: var(--input) !important;
            color: var(--foreground) !important;
            border: 1px solid var(--border) !important;
        }

        input::placeholder, textarea::placeholder {
            color: var(--muted-foreground) !important;
        }

        /* Fix any white text issues */
        .text-white {
            color: var(--foreground) !important;
        }

        /* Ensure message text is visible */
        .message-content, .content-text {
            color: var(--foreground) !important;
        }

        /* Fix dropdown text */
        .dropdown-menu, .quick-model-dropdown {
            background-color: var(--popover) !important;
            color: var(--popover-foreground) !important;
        }

        /* Thinking indicator styles */
        .thinking-indicator {
            background-color: var(--muted);
            border: 1px solid var(--border);
            color: var(--muted-foreground);
        }

        .thinking-indicator.collapsed .thinking-content {
            display: none;
        }

        .thinking-content {
            font-family: monospace;
            line-height: 1.4;
            white-space: pre-wrap;
        }

        .rotate-180 {
            transform: rotate(180deg);
        }

        /* Fix text spacing and wrapping issues */
        .message-content {
            word-wrap: break-word;
            word-break: break-word;
            white-space: pre-wrap;
            line-height: 1.5;
            max-width: 100%;
            overflow-wrap: break-word;
        }

        .thinking-content {
            word-wrap: break-word;
            word-break: break-word;
            white-space: pre-wrap;
            line-height: 1.4;
            max-width: 100%;
            overflow-wrap: break-word;
        }

        /* Ensure messages don't overflow */
        .assistant-message, .user-message {
            max-width: 100%;
            overflow: hidden;
        }

        .assistant-message .flex-1, .user-message .flex-1 {
            min-width: 0;
            max-width: 100%;
        }

        /* Attachment preview styles */
        .attachment-preview {
            position: relative;
            width: 60px;
            height: 60px;
            border: 1px solid var(--border);
            border-radius: 6px;
            overflow: hidden;
            background-color: var(--muted);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .attachment-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .attachment-remove {
            position: absolute;
            top: -6px;
            right: -6px;
            width: 16px;
            height: 16px;
            background-color: var(--destructive);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            cursor: pointer;
            line-height: 1;
        }

        .attachment-remove:hover {
            background-color: #b91c1c;
        }

        .attachment-icon {
            font-size: 24px;
            color: var(--muted-foreground);
        }

        /* Text file preview styles */
        .text-file-preview {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            font-size: 10px;
        }

        .file-header {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 4px;
            padding: 2px;
            background: rgba(0,0,0,0.1);
            border-radius: 2px;
        }

        .file-icon {
            font-size: 12px;
        }

        .file-name {
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 40px;
        }

        .file-content-preview {
            flex: 1;
            font-size: 8px;
            line-height: 1.2;
            color: var(--muted-foreground);
            overflow: hidden;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        /* =================== VISUAL ENHANCEMENTS =================== */
        
        /* Modern container with subtle depth */
        .chat-container {
            background: linear-gradient(145deg, var(--background), var(--card));
            border-radius: 12px;
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.1),
                0 2px 4px -1px rgba(0, 0, 0, 0.06),
                inset 0 1px 0 rgba(35, 36, 37, 0.3);
        }
        
        /* Enhanced buttons with depth and hover effects */
        button, .button {
            border-radius: 8px;
            box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #232425;
        }
        
        button:hover, .button:hover {
            transform: translateY(-1px);
            box-shadow: rgba(0, 0, 0, 0.5) 0px 4px 8px, rgba(0, 0, 0, 0.4) 0px 10px 18px -3px, rgba(0, 0, 0, 0.3) 0px -3px 0px inset;
        }
        
        button:active, .button:active {
            transform: translateY(0);
            box-shadow: rgba(0, 0, 0, 0.3) 0px 1px 2px, rgba(0, 0, 0, 0.2) 0px 3px 6px -3px, rgba(0, 0, 0, 0.4) 0px -5px 0px inset;
        }
        
        /* Enhanced textarea with subtle inset effect */
        textarea, input[type="text"], input[type="email"], input[type="password"], input, select {
            background: linear-gradient(145deg, #1a1a1a, #2d2d2d, #404040);
            border: 1px solid #232425 !important;
            border-radius: 10px;
            box-shadow: 
                inset 0 2px 4px rgba(0, 0, 0, 0.3),
                inset 0 1px 2px rgba(0, 0, 0, 0.5),
                rgba(0, 0, 0, 0.4) 0px 2px 4px, 
                rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, 
                rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
            transition: all 0.2s ease;
        }
        
        /* Sexy disabled state for textarea */
        textarea:disabled, input:disabled {
            background: linear-gradient(145deg, #0f0f0f, #1a1a1a, #252525);
            opacity: 0.8;
            box-shadow: 
                inset 0 3px 6px rgba(0, 0, 0, 0.4),
                inset 0 2px 4px rgba(0, 0, 0, 0.6),
                rgba(0, 0, 0, 0.2) 0px 1px 2px;
        }
        
        textarea:focus, input:focus {
            border-color: var(--ring);
            box-shadow: 
                inset 0 2px 4px rgba(0, 0, 0, 0.06),
                0 0 0 2px rgba(59, 130, 246, 0.1),
                0 1px 3px rgba(0, 0, 0, 0.1);
            outline: none;
        }
        
        /* Message bubbles with depth */
        .message {
            border-radius: 12px;
            box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
            border: 1px solid #232425;
            backdrop-filter: blur(10px);
        }
        
        .user-message {
            background: linear-gradient(135deg, var(--primary), #3b82f6);
            box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
        }
        
        .assistant-message {
            background: linear-gradient(145deg, var(--card), var(--secondary));
            border: 1px solid #232425;
        }
        
        /* Enhanced dropdown menus */
        .dropdown-menu {
            background: linear-gradient(145deg, var(--popover), var(--card));
            border: 1px solid #232425;
            border-radius: 12px;
            box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
            backdrop-filter: blur(16px);
        }
        
        .menu-item {
            border-radius: 8px;
            transition: all 0.15s ease;
        }
        
        .menu-item:hover {
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            transform: translateX(2px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* Enhanced header area */
        .header-section {
            background: linear-gradient(145deg, var(--card), var(--background));
            border-bottom: 1px solid var(--border);
            box-shadow: 
                0 1px 3px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(35, 36, 37, 0.3);
        }
        
        /* Attachment previews with style */
        .attachment-preview {
            border-radius: 8px;
            border: 1px solid #232425;
            background: linear-gradient(145deg, var(--card), var(--secondary));
            box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
            transition: all 0.2s ease;
        }
        
        .attachment-preview:hover {
            transform: translateY(-1px);
            box-shadow: rgba(0, 0, 0, 0.5) 0px 4px 8px, rgba(0, 0, 0, 0.4) 0px 10px 18px -3px, rgba(0, 0, 0, 0.3) 0px -3px 0px inset;
        }
        
        /* Enhanced toggle switches */
        .toggle-switch {
            border-radius: 20px;
            box-shadow: 
                inset 0 2px 4px rgba(0, 0, 0, 0.1),
                0 1px 2px rgba(35, 36, 37, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .toggle-switch.active {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            box-shadow: 
                0 2px 4px rgba(59, 130, 246, 0.3),
                inset 0 1px 0 rgba(35, 36, 37, 0.25);
        }
        
        /* Glassy effects for modern look */
        .glass-effect {
            background: rgba(35, 36, 37, 0.15);
            backdrop-filter: blur(16px);
            border: 1px solid var(--border);
        }
        
        /* Subtle animations */
        @keyframes gentle-float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-2px); }
        }
        
        .float-animation {
            animation: gentle-float 3s ease-in-out infinite;
        }
        
        /* Dark mode enhancements */
        .dark button, .dark .button {
            box-shadow: 
                0 1px 3px rgba(0, 0, 0, 0.3),
                0 1px 2px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(35, 36, 37, 0.3);
        }
        
        .dark button:hover, .dark .button:hover {
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.4),
                0 2px 4px -1px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(35, 36, 37, 0.3);
        }
        
        .dark .message {
            box-shadow: 
                0 1px 3px rgba(0, 0, 0, 0.3),
                0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        /* Micro-interactions */
        .interactive {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .interactive:hover {
            transform: scale(1.02);
        }
        
        .interactive:active {
            transform: scale(0.98);
        }
        
        /* Contoured border around photo/attachment icon */
        #attachBtn {
            border: 1px solid #232425;
            border-radius: 8px;
            box-shadow: 
                rgba(0, 0, 0, 0.4) 0px 2px 4px, 
                rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, 
                rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            transition: all 0.2s ease;
        }
        
        #attachBtn:hover {
            transform: translateY(-1px);
            box-shadow: 
                rgba(0, 0, 0, 0.5) 0px 4px 8px, 
                rgba(0, 0, 0, 0.4) 0px 10px 18px -3px, 
                rgba(0, 0, 0, 0.3) 0px -3px 0px inset;
            background: linear-gradient(145deg, #333333, #222222);
        }
        
        #attachBtn:active {
            transform: translateY(0);
            box-shadow: 
                rgba(0, 0, 0, 0.3) 0px 1px 2px, 
                rgba(0, 0, 0, 0.4) 0px -5px 0px inset;
        }
        
    </style>
</head>
<body class="bg-background text-foreground">
    <div class="flex h-screen flex-col">
        <!-- Header -->
        <div class="flex items-center justify-between border-b border-border px-4 py-3">
            <div class="flex items-center gap-2">
                <span class="relative flex shrink-0 overflow-hidden ring-border size-8 rounded-xl bg-secondary p-0.5 ring">
                    <div class="aspect-square size-full bg-primary rounded-lg flex items-center justify-center text-primary-foreground font-bold text-sm">
                        <img src="icons/icon32.png" alt="SideLlama" class="w-6 h-6" />
                    </div>
                </span>
                <div>
                    <h1 class="font-semibold">SideLlama</h1>
                    <p class="text-muted-foreground text-xs" id="currentModel">qwen2.5:7b</p>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <!-- Context Toggle Button -->
                <button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground h-8 px-3 py-2" id="contextToggle" title="Toggle page context">
                    📄
                </button>
                <!-- Search Button -->
                <button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground h-8 px-3 py-2" id="searchToggle" title="Web search">
                    🔍
                </button>
                <!-- Menu Button -->
                <div class="relative">
                    <button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2" id="menuButton">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="12" cy="5" r="1"></circle>
                            <circle cx="12" cy="19" r="1"></circle>
                        </svg>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <div class="menu-item" id="settingsBtn">
                            ⚙️ Open Settings
                        </div>
                        <div class="menu-item" id="modelSelectBtn">
                            🤖 Select Model
                        </div>
                        <div class="menu-item danger" id="deleteHistoryBtn">
                            🗑️ Delete history
                        </div>
                        <div class="menu-item" id="resetContextBtn">
                            🔄 Fresh Context
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Context Indicator -->
        <div class="context-indicator" id="contextIndicator" style="display: none;">
            <span>📄</span>
            <span id="contextText">Page context disabled</span>
            <button class="ml-auto text-xs hover:text-accent" id="contextClose">✕</button>
        </div>

        <!-- Model Selector -->
        <div class="model-selector" id="modelSelector">
            <div class="text-sm font-semibold mb-3 text-muted-foreground">Select Model</div>
            <div class="space-y-2" id="modelOptions">
                <div class="model-option" data-model="qwen2.5:7b">
                    <div class="model-radio selected"></div>
                    <div class="text-sm">qwen2.5:7b</div>
                </div>
            </div>
        </div>

        <!-- Chat Container -->
        <div class="relative flex size-full flex-col overflow-y-hidden">
            <div class="flex-grow overflow-y-hidden">
                <div class="relative flex size-full">
                    <div class="size-full rounded-[inherit] scrollbar-none" style="overflow: hidden scroll;" id="messagesContainer">
                        <div style="min-width: 100%; display: table;">

                            <!-- Typing Indicator -->
                            <div class="typing-indicator flex-col gap-2 p-3" id="typingIndicator">
                                <div class="flex items-center gap-2">
                                    <span class="relative flex shrink-0 overflow-hidden ring-border size-6 rounded-lg bg-secondary p-0.5 ring">
                                        <div class="aspect-square size-full bg-primary rounded flex items-center justify-center text-primary-foreground text-xs">
                                            🤖
                                        </div>
                                    </span>
                                    <div class="font-mono text-xs font-bold" id="typingModelName">qwen2.5:7b</div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="typing-dots">
                                        <div class="typing-dot"></div>
                                        <div class="typing-dot"></div>
                                        <div class="typing-dot"></div>
                                    </div>
                                    <span class="text-xs text-muted-foreground">AI is thinking...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Context Status Indicator -->
                <div class="context-status hidden px-3 py-2 bg-yellow-500/10 border-l-4 border-yellow-500 text-yellow-400 text-sm mb-2" id="contextStatus">
                    📝 Context: Processing conversation history
                </div>
            </div>
        </div>

        <!-- Search Input (Hidden by default) -->
        <div class="px-3 pb-2" id="searchContainer" style="display: none;">
            <div class="flex gap-2">
                <input type="text" class="flex-1 bg-input border border-border rounded-md px-3 py-2 text-sm" placeholder="Search the web..." id="searchInput">
                <button class="bg-primary text-primary-foreground px-4 py-2 rounded-md text-sm font-medium" id="searchButton">
                    Search
                </button>
            </div>
        </div>

        <!-- Input Area -->
        <div class="z-10 px-3 pb-3">
            <div class="flex flex-col rounded-xl border border-border">
                <!-- Model Switcher Bar -->
                <div class="flex items-center justify-between px-3 py-2 border-b border-border bg-muted/20">
                    <div class="flex items-center gap-2">
                        <div class="relative">
                            <button class="flex items-center gap-2 text-xs bg-accent hover:bg-accent/80 rounded-md px-2 py-1 transition-colors" id="quickModelSelect">
                                <span class="model-indicator" id="modelIndicator">🤖</span>
                                <span id="quickModelName">qwen2.5:7b</span>
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>
                            <div class="quick-model-dropdown absolute bottom-full left-0 mb-1 bg-popover border border-border rounded-md shadow-lg min-w-48 max-h-40 overflow-y-auto hidden z-50" id="quickModelDropdown">
                                <!-- Models will be populated here -->
                            </div>
                        </div>
                        <div class="model-capabilities text-xs text-muted-foreground" id="modelCapabilities">
                            🛠️ Tools • 💬 Chat
                        </div>
                    </div>
                    <div class="flex items-center gap-1">
                        <div class="model-stats text-xs text-muted-foreground" id="modelStats">
                        </div>
                    </div>
                </div>
                
                <!-- Attachments Preview Area -->
                <div class="attachments-preview px-3 pt-2 hidden" id="attachmentsPreview">
                    <div class="flex gap-2 flex-wrap" id="attachmentsList">
                        <!-- Attachment previews will appear here -->
                    </div>
                </div>
                
                <div class="relative">
                    <textarea 
                        class="scrollbar-none min-h-[120px] w-full resize-none bg-transparent pl-12 pr-20 p-3 pb-1.5 text-sm outline-none" 
                        placeholder=""
                        id="messageInput"
                    ></textarea>
                    <!-- Paperclip button on left -->
                    <div class="absolute left-2 top-1/2 transform -translate-y-1/2">
                        <label for="fileInput" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium size-8 cursor-pointer" id="attachBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-gray-500">
                                <path d="M13.234 20.252 21 12.3"></path>
                                <path d="m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486"></path>
                            </svg>
                        </label>
                        <input type="file" class="hidden" accept="image/*" multiple id="fileInput">
                    </div>
                    <!-- Send/Stop buttons on right -->
                    <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex gap-1">
                        <button class="bg-red-500 text-white inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium disabled:pointer-events-none disabled:opacity-50 size-8 cursor-pointer transition-all hidden" id="stopButton" title="Stop generation">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect width="6" height="6" x="9" y="9"></rect>
                            </svg>
                        </button>
                        <button class="bg-primary text-primary-foreground inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium disabled:pointer-events-none disabled:opacity-50 size-8 cursor-pointer transition-all disabled:bg-gray-200 disabled:text-gray-400" id="sendButton">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
                                <path d="m5 12 7-7 7 7"></path>
                                <path d="M12 19V5"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <!-- Status Bar -->
                <div class="flex items-center justify-center gap-2 px-3 pb-2">
                    <div class="text-xs text-muted-foreground" id="statusBar">
                        SideLlama
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="shared-utils.js"></script>
    <script src="model-utils.js"></script>
    <script src="sidepanel.js"></script>
</body>
</html>